{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\roman\\\\Pictures\\\\Case\\\\row\\\\src\\\\components\\\\common\\\\collectData.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { Children, useState, useEffect, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport PageVisibility from 'react-page-visibility';\nimport { performerService } from '@services/performer.service';\n// let interval: any;\n\nconst CollectData = ({\n  children,\n  loggedIn\n}) => {\n  const [rotate, setRotate] = useState(true);\n  const timeout = useRef(null);\n  const sendRequest = async () => {\n    if (timeout.current) clearTimeout(timeout.current);\n    if (!loggedIn || !rotate) return;\n    await performerService.setInternalProfile();\n    timeout.current = setTimeout(() => {\n      sendRequest();\n    }, 10 * 60 * 1000);\n  };\n  const cancelSendRequest = () => {\n    timeout.current && clearTimeout(timeout.current);\n  };\n  const handleVisibilityChange = isVisible => {\n    setRotate(isVisible);\n  };\n  useEffect(() => {\n    if (!loggedIn || !rotate) return cancelSendRequest();\n    sendRequest();\n    return () => {\n      cancelSendRequest();\n    };\n  }, [loggedIn, rotate]);\n  return __jsx(PageVisibility, {\n    onChange: handleVisibilityChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 5\n    }\n  }, Children.only(children));\n};\nconst mapStates = state => ({\n  loggedIn: state.auth.loggedIn\n});\nexport default connect(mapStates, null)(CollectData);","map":{"version":3,"names":["Children","useState","useEffect","useRef","connect","PageVisibility","performerService","CollectData","children","loggedIn","rotate","setRotate","timeout","sendRequest","current","clearTimeout","setInternalProfile","setTimeout","cancelSendRequest","handleVisibilityChange","isVisible","__jsx","onChange","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","only","mapStates","state","auth"],"sources":["C:/Users/roman/Pictures/Case/row/src/components/common/collectData.tsx"],"sourcesContent":["import {\r\n  Children, useState, useEffect, useRef\r\n} from 'react';\r\nimport { connect } from 'react-redux';\r\nimport PageVisibility from 'react-page-visibility';\r\nimport { performerService } from '@services/performer.service';\r\n\r\ninterface IProps {\r\n  children: any;\r\n  loggedIn: boolean;\r\n}\r\n// let interval: any;\r\n\r\nconst CollectData = ({ children, loggedIn }: IProps) => {\r\n  const [rotate, setRotate] = useState(true) as any;\r\n  const timeout = useRef(null) as any;\r\n\r\n  const sendRequest = async () => {\r\n    if (timeout.current) clearTimeout(timeout.current);\r\n    if (!loggedIn || !rotate) return;\r\n    await performerService.setInternalProfile();\r\n    timeout.current = setTimeout(() => {\r\n      sendRequest();\r\n    }, 10 * 60 * 1000);\r\n  };\r\n\r\n  const cancelSendRequest = () => {\r\n    timeout.current && clearTimeout(timeout.current);\r\n  };\r\n\r\n  const handleVisibilityChange = (isVisible) => {\r\n    setRotate(isVisible);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!loggedIn || !rotate) return cancelSendRequest();\r\n    sendRequest();\r\n    return () => {\r\n      cancelSendRequest();\r\n    };\r\n  }, [loggedIn, rotate]);\r\n\r\n  return (\r\n    <PageVisibility onChange={handleVisibilityChange}>\r\n      {Children.only(children)}\r\n    </PageVisibility>\r\n  );\r\n};\r\n\r\nconst mapStates = (state: any) => ({\r\n  loggedIn: state.auth.loggedIn\r\n});\r\n\r\nexport default connect(mapStates, null)(CollectData);\r\n"],"mappings":";;;AAAA,SACEA,QAAQ,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAChC,OAAO;AACd,SAASC,OAAO,QAAQ,aAAa;AACrC,OAAOC,cAAc,MAAM,uBAAuB;AAClD,SAASC,gBAAgB,QAAQ,6BAA6B;AAM9D;;AAEA,MAAMC,WAAW,GAAGA,CAAC;EAAEC,QAAQ;EAAEC;AAAiB,CAAC,KAAK;EACtD,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGV,QAAQ,CAAC,IAAI,CAAQ;EACjD,MAAMW,OAAO,GAAGT,MAAM,CAAC,IAAI,CAAQ;EAEnC,MAAMU,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAID,OAAO,CAACE,OAAO,EAAEC,YAAY,CAACH,OAAO,CAACE,OAAO,CAAC;IAClD,IAAI,CAACL,QAAQ,IAAI,CAACC,MAAM,EAAE;IAC1B,MAAMJ,gBAAgB,CAACU,kBAAkB,CAAC,CAAC;IAC3CJ,OAAO,CAACE,OAAO,GAAGG,UAAU,CAAC,MAAM;MACjCJ,WAAW,CAAC,CAAC;IACf,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;EACpB,CAAC;EAED,MAAMK,iBAAiB,GAAGA,CAAA,KAAM;IAC9BN,OAAO,CAACE,OAAO,IAAIC,YAAY,CAACH,OAAO,CAACE,OAAO,CAAC;EAClD,CAAC;EAED,MAAMK,sBAAsB,GAAIC,SAAS,IAAK;IAC5CT,SAAS,CAACS,SAAS,CAAC;EACtB,CAAC;EAEDlB,SAAS,CAAC,MAAM;IACd,IAAI,CAACO,QAAQ,IAAI,CAACC,MAAM,EAAE,OAAOQ,iBAAiB,CAAC,CAAC;IACpDL,WAAW,CAAC,CAAC;IACb,OAAO,MAAM;MACXK,iBAAiB,CAAC,CAAC;IACrB,CAAC;EACH,CAAC,EAAE,CAACT,QAAQ,EAAEC,MAAM,CAAC,CAAC;EAEtB,OACEW,KAAA,CAAChB,cAAc;IAACiB,QAAQ,EAAEH,sBAAuB;IAAAI,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAC9C5B,QAAQ,CAAC6B,IAAI,CAACrB,QAAQ,CACT,CAAC;AAErB,CAAC;AAED,MAAMsB,SAAS,GAAIC,KAAU,KAAM;EACjCtB,QAAQ,EAAEsB,KAAK,CAACC,IAAI,CAACvB;AACvB,CAAC,CAAC;AAEF,eAAeL,OAAO,CAAC0B,SAAS,EAAE,IAAI,CAAC,CAACvB,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}