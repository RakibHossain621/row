{"ast":null,"code":"function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport { merge } from 'lodash';\nimport { createReducers } from '@lib/redux';\nimport { getComments, getCommentsSuccess, getCommentsFail, moreComment, moreCommentSuccess, moreCommentFail, createComment, createCommentFail, createCommentSuccess, deleteCommentSuccess } from './actions';\nconst initialState = {\n  activeObject: {},\n  commentMapping: {},\n  comment: {\n    requesting: false,\n    error: null,\n    success: false,\n    data: null\n  }\n};\nconst commentReducers = [{\n  on: getComments,\n  reducer(state, data) {\n    const {\n      objectId\n    } = data.payload;\n    const nextState = _objectSpread({}, state);\n    nextState.activeObject._id = objectId;\n    nextState.commentMapping[objectId] = {\n      requesting: true,\n      items: [],\n      total: 0\n    };\n    return _objectSpread({}, nextState);\n  }\n}, {\n  on: getCommentsSuccess,\n  reducer(state, data) {\n    const nextState = _objectSpread({}, state);\n    const objectId = data.payload.data && data.payload.data.length ? data.payload.data[0].objectId : nextState.activeObject._id;\n    if (objectId) {\n      nextState.commentMapping[objectId] = {\n        items: data.payload.data,\n        total: data.payload.total,\n        requesting: false\n      };\n    }\n    return _objectSpread(_objectSpread({}, nextState), {}, {\n      // Remove me\n      comment: {\n        requesting: false,\n        error: null,\n        success: false,\n        data: null\n      }\n    });\n  }\n}, {\n  on: getCommentsFail,\n  reducer(state, data) {\n    const nextState = _objectSpread({}, state);\n    const objectId = data.payload.data && data.payload.data.length ? data.payload.data[0].objectId : nextState.activeObject._id;\n    if (objectId) {\n      nextState.commentMapping[objectId] = {\n        items: [],\n        total: 0,\n        requesting: false\n      };\n    }\n    return _objectSpread({}, nextState);\n  }\n}, {\n  on: moreComment,\n  reducer(state, data) {\n    const {\n      objectId\n    } = data.payload;\n    const nextState = _objectSpread({}, state);\n    nextState.commentMapping[objectId].requesting = true;\n    return _objectSpread({}, state);\n  }\n}, {\n  on: moreCommentSuccess,\n  reducer(state, data) {\n    const nextState = _objectSpread({}, state);\n    const objectId = data.payload.data && data.payload.data.length ? data.payload.data[0].objectId : null;\n    if (objectId) {\n      nextState.commentMapping[objectId] = {\n        items: [...nextState.commentMapping[objectId].items, ...data.payload.data],\n        total: data.payload.total,\n        requesting: false\n      };\n    }\n    return _objectSpread(_objectSpread({}, nextState), {}, {\n      // Remove me\n      comment: {\n        requesting: false,\n        error: null,\n        success: false,\n        data: null\n      }\n    });\n  }\n}, {\n  on: moreCommentFail,\n  reducer(state, data) {\n    const nextState = _objectSpread({}, state);\n    const objectId = data.payload.data && data.payload.data.length ? data.payload.data[0].objectId : null;\n    if (objectId) {\n      nextState.commentMapping[objectId] = {\n        items: [],\n        total: 0,\n        requesting: false\n      };\n    }\n    return _objectSpread({}, nextState);\n  }\n}, {\n  on: createComment,\n  reducer(state) {\n    return _objectSpread(_objectSpread({}, state), {}, {\n      comment: _objectSpread(_objectSpread({}, state.comment), {}, {\n        requesting: true,\n        error: null,\n        success: false\n      })\n    });\n  }\n}, {\n  on: createCommentSuccess,\n  reducer(state, data) {\n    var _nextState$commentMap;\n    const nextState = _objectSpread({}, state);\n    const {\n      objectId\n    } = data.payload;\n    if (!(nextState !== null && nextState !== void 0 && nextState.commentMapping[objectId]) || !(nextState !== null && nextState !== void 0 && (_nextState$commentMap = nextState.commentMapping[objectId]) !== null && _nextState$commentMap !== void 0 && _nextState$commentMap.items)) {\n      nextState.commentMapping[objectId] = {};\n      nextState.commentMapping[objectId].items = [];\n      nextState.commentMapping[objectId].total = 0;\n    }\n    nextState.commentMapping[objectId].items.unshift(data.payload);\n    nextState.commentMapping[objectId].total += 1;\n    return _objectSpread(_objectSpread({}, nextState), {}, {\n      comment: {\n        requesting: false,\n        data: data.payload,\n        error: null,\n        success: true\n      }\n    });\n  }\n}, {\n  on: createCommentFail,\n  reducer(state, data) {\n    return _objectSpread(_objectSpread({}, state), {}, {\n      comment: {\n        requesting: false,\n        data: null,\n        error: data.payload,\n        success: false\n      }\n    });\n  }\n}, {\n  on: deleteCommentSuccess,\n  reducer(state, data) {\n    const nextState = _objectSpread({}, state);\n    const {\n      objectId,\n      _id\n    } = data.payload;\n    nextState.commentMapping[objectId].items.splice(nextState.commentMapping[objectId].items.findIndex(item => item._id === _id), 1);\n    nextState.commentMapping[objectId].total -= 1;\n    return _objectSpread({}, nextState);\n  }\n}];\nexport default merge({}, createReducers('comment', [commentReducers], initialState));","map":{"version":3,"names":["merge","createReducers","getComments","getCommentsSuccess","getCommentsFail","moreComment","moreCommentSuccess","moreCommentFail","createComment","createCommentFail","createCommentSuccess","deleteCommentSuccess","initialState","activeObject","commentMapping","comment","requesting","error","success","data","commentReducers","on","reducer","state","objectId","payload","nextState","_objectSpread","_id","items","total","length","_nextState$commentMap","unshift","splice","findIndex","item"],"sources":["C:/Users/Rokibul/Documents/case/src/redux/comment/reducers.ts"],"sourcesContent":["import { merge } from 'lodash';\nimport { createReducers } from '@lib/redux';\nimport { IReduxAction } from '@interfaces/redux';\nimport {\n  getComments, getCommentsSuccess, getCommentsFail,\n  moreComment, moreCommentSuccess, moreCommentFail,\n  createComment, createCommentFail, createCommentSuccess,\n  deleteCommentSuccess\n} from './actions';\n\nconst initialState = {\n  activeObject: {},\n  commentMapping: {},\n  comment: {\n    requesting: false,\n    error: null,\n    success: false,\n    data: null\n  }\n};\n\nconst commentReducers = [\n  {\n    on: getComments,\n    reducer(state: any, data: IReduxAction<any>) {\n      const { objectId } = data.payload;\n      const nextState = { ...state };\n      nextState.activeObject._id = objectId;\n      nextState.commentMapping[objectId] = {\n        requesting: true,\n        items: [],\n        total: 0\n      };\n      return {\n        ...nextState\n      };\n    }\n  },\n  {\n    on: getCommentsSuccess,\n    reducer(state: any, data: any) {\n      const nextState = { ...state };\n      const objectId = data.payload.data && data.payload.data.length ? data.payload.data[0].objectId : nextState.activeObject._id;\n      if (objectId) {\n        nextState.commentMapping[objectId] = {\n          items: data.payload.data,\n          total: data.payload.total,\n          requesting: false\n        };\n      }\n      return {\n        // Fix me page not rerender\n        ...nextState,\n        // Remove me\n        comment: {\n          requesting: false,\n          error: null,\n          success: false,\n          data: null\n        }\n      };\n    }\n  },\n  {\n    on: getCommentsFail,\n    reducer(state: any, data: any) {\n      const nextState = { ...state };\n      const objectId = data.payload.data && data.payload.data.length ? data.payload.data[0].objectId : nextState.activeObject._id;\n      if (objectId) {\n        nextState.commentMapping[objectId] = {\n          items: [],\n          total: 0,\n          requesting: false\n        };\n      }\n      return {\n        ...nextState\n      };\n    }\n  },\n  {\n    on: moreComment,\n    reducer(state: any, data: IReduxAction<any>) {\n      const { objectId } = data.payload;\n      const nextState = { ...state };\n      nextState.commentMapping[objectId].requesting = true;\n      return {\n        ...state\n      };\n    }\n  },\n  {\n    on: moreCommentSuccess,\n    reducer(state: any, data: any) {\n      const nextState = { ...state };\n      const objectId = data.payload.data && data.payload.data.length ? data.payload.data[0].objectId : null;\n      if (objectId) {\n        nextState.commentMapping[objectId] = {\n          items: [...nextState.commentMapping[objectId].items, ...data.payload.data],\n          total: data.payload.total,\n          requesting: false\n        };\n      }\n      return {\n        // Fix me page not rerender\n        ...nextState,\n        // Remove me\n        comment: {\n          requesting: false,\n          error: null,\n          success: false,\n          data: null\n        }\n      };\n    }\n  },\n  {\n    on: moreCommentFail,\n    reducer(state: any, data: any) {\n      const nextState = { ...state };\n      const objectId = data.payload.data && data.payload.data.length ? data.payload.data[0].objectId : null;\n      if (objectId) {\n        nextState.commentMapping[objectId] = {\n          items: [],\n          total: 0,\n          requesting: false\n        };\n      }\n      return {\n        ...nextState\n      };\n    }\n  },\n  {\n    on: createComment,\n    reducer(state: any) {\n      return {\n        ...state,\n        comment: {\n          ...state.comment,\n          requesting: true,\n          error: null,\n          success: false\n        }\n      };\n    }\n  },\n  {\n    on: createCommentSuccess,\n    reducer(state: any, data: any) {\n      const nextState = { ...state };\n      const { objectId } = data.payload;\n      if (!nextState?.commentMapping[objectId] || !nextState?.commentMapping[objectId]?.items) {\n        nextState.commentMapping[objectId] = {};\n        nextState.commentMapping[objectId].items = [];\n        nextState.commentMapping[objectId].total = 0;\n      }\n      nextState.commentMapping[objectId].items.unshift(data.payload);\n      nextState.commentMapping[objectId].total += 1;\n      return {\n        ...nextState,\n        comment: {\n          requesting: false,\n          data: data.payload,\n          error: null,\n          success: true\n        }\n      };\n    }\n  },\n  {\n    on: createCommentFail,\n    reducer(state: any, data: any) {\n      return {\n        ...state,\n        comment: {\n          requesting: false,\n          data: null,\n          error: data.payload,\n          success: false\n        }\n      };\n    }\n  },\n  {\n    on: deleteCommentSuccess,\n    reducer(state: any, data: any) {\n      const nextState = { ...state };\n      const { objectId, _id } = data.payload;\n      nextState.commentMapping[objectId].items.splice(\n        nextState.commentMapping[objectId].items.findIndex((item) => item._id === _id),\n        1\n      );\n      nextState.commentMapping[objectId].total -= 1;\n      return {\n        ...nextState\n      };\n    }\n  }\n];\n\nexport default merge({}, createReducers('comment', [commentReducers], initialState));\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}