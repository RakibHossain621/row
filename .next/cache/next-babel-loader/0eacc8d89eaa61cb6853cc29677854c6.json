{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\roman\\\\Pictures\\\\Case\\\\row\\\\src\\\\components\\\\common\\\\buttonFollow.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/* eslint-disable react/require-default-props */\nimport { PureComponent } from 'react';\nimport { followService } from 'src/services';\nimport { message } from 'antd';\nimport { onFollow } from '@redux/performer/actions';\nimport { connect } from 'react-redux';\nimport { AppButton } from '@components/ui/shared/AppButton';\nimport { updateCurrentUser } from '@redux/user/actions';\nimport { withRouter } from 'next/router';\nclass ButtonFollow extends PureComponent {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"state\", {\n      status: false,\n      loading: false\n    });\n    _defineProperty(this, \"handleFollow\", async () => {\n      const {\n        status\n      } = this.state;\n      const {\n        targetId,\n        sourceId,\n        getPerformerList,\n        onFollow: dispatchOnFollow,\n        updateFollower,\n        updateCurrentUser,\n        user\n      } = this.props;\n      try {\n        if (status) {\n          if (!window.confirm('Are you sure you want to unfollow this person?')) {\n            return;\n          }\n          const stats = _objectSpread(_objectSpread({}, user === null || user === void 0 ? void 0 : user.stats), {}, {\n            totalFollowing: (user === null || user === void 0 ? void 0 : user.stats.totalFollowing) - 1\n          });\n          updateCurrentUser(_objectSpread(_objectSpread({}, user), {}, {\n            stats\n          }));\n          await this.setState({\n            loading: true\n          });\n          await followService.delete(targetId);\n          this.setState({\n            status: false\n          });\n          updateFollower && updateFollower(-1);\n          dispatchOnFollow && dispatchOnFollow({\n            action: 'delete',\n            performerId: targetId\n          });\n        } else {\n          await this.setState({\n            loading: true\n          });\n          const stats = _objectSpread(_objectSpread({}, user === null || user === void 0 ? void 0 : user.stats), {}, {\n            totalFollowing: (user === null || user === void 0 ? void 0 : user.stats.totalFollowing) + 1\n          });\n          updateCurrentUser(_objectSpread(_objectSpread({}, user), {}, {\n            stats\n          }));\n          await followService.create({\n            targetId,\n            sourceId\n          });\n          this.setState({\n            status: true\n          });\n          dispatchOnFollow && dispatchOnFollow({\n            action: 'create',\n            performerId: targetId\n          });\n          updateFollower && updateFollower(1);\n          getPerformerList();\n        }\n      } catch (e) {\n        const err = await e;\n        message.error(err.message || 'error occured, please try again later');\n      } finally {\n        this.setState({\n          loading: false\n        });\n      }\n    });\n  }\n  componentDidMount() {\n    const {\n      isFollow\n    } = this.props;\n    if (isFollow || isFollow === undefined) {\n      this.setState({\n        status: true\n      });\n    }\n  }\n  render() {\n    const {\n      status,\n      loading\n    } = this.state;\n    const {\n      isFollow,\n      title,\n      performer,\n      sourceId,\n      targetId,\n      isTrending,\n      router\n    } = this.props;\n    if (router.pathname !== '/model' && status) {\n      return null;\n    }\n    return __jsx(React.Fragment, null, isFollow ? __jsx(React.Fragment, null, isTrending ? __jsx(AppButton, {\n      className: `w-full rounded-full bg-transparent text-white border border-white py-1 px-2 hover:bg-black/90 hover:border-black/90`,\n      loading: loading,\n      size: \"sm\",\n      onClick: this.handleFollow,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 15\n      }\n    }, __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }\n    }, \"Unfollow\")) : __jsx(AppButton, {\n      className: `rounded-t-none w-full rounded-b-lg ${performer.gender === 'male' ? 'bg-blue-900' : ''}`,\n      loading: loading,\n      onClick: this.handleFollow,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 15\n      }\n    }, __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 17\n      }\n    }, \"Unfollow\"))) : __jsx(React.Fragment, null, isTrending ? __jsx(AppButton, {\n      className: `w-full rounded-full bg-transparent text-white border border-white py-1 px-2 hover:bg-black/90`,\n      size: \"sm\",\n      loading: loading,\n      onClick: this.handleFollow,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 15\n      }\n    }, __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }\n    }, title || 'Follow')) : __jsx(AppButton, {\n      className: `rounded-t-none w-full rounded-b-lg ${performer.gender === 'male' ? 'bg-blue-900' : ''}`,\n      loading: loading,\n      onClick: this.handleFollow,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 15\n      }\n    }, __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 17\n      }\n    }, title || 'Follow'))));\n  }\n}\nconst mapState = state => ({\n  user: _objectSpread({}, state.user.current)\n});\nconst mapDispatch = {\n  onFollow,\n  updateCurrentUser\n};\nexport default withRouter(connect(mapState, mapDispatch)(ButtonFollow));","map":{"version":3,"names":["PureComponent","followService","message","onFollow","connect","AppButton","updateCurrentUser","withRouter","ButtonFollow","constructor","args","_defineProperty","status","loading","state","targetId","sourceId","getPerformerList","dispatchOnFollow","updateFollower","user","props","window","confirm","stats","_objectSpread","totalFollowing","setState","delete","action","performerId","create","e","err","error","componentDidMount","isFollow","undefined","render","title","performer","isTrending","router","pathname","__jsx","React","Fragment","className","size","onClick","handleFollow","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","gender","mapState","current","mapDispatch"],"sources":["C:/Users/roman/Pictures/Case/row/src/components/common/buttonFollow.tsx"],"sourcesContent":["/* eslint-disable react/require-default-props */\r\nimport { PureComponent } from 'react';\r\nimport { followService } from 'src/services';\r\nimport { message } from 'antd';\r\nimport { onFollow } from '@redux/performer/actions';\r\nimport { connect } from 'react-redux';\r\nimport { IPerformer } from '@interfaces/performer';\r\nimport { AppButton } from '@components/ui/shared/AppButton';\r\nimport { updateCurrentUser } from '@redux/user/actions';\r\nimport { NextRouter } from 'next/router';\r\nimport { withRouter } from 'next/router';\r\n\r\n\r\ninterface IProps {\r\n  isFollow: boolean;\r\n  targetId: string;\r\n  sourceId: string;\r\n  updateCurrentUser: Function;\r\n  getPerformerList: Function;\r\n  isHideOnClick: boolean;\r\n  title?: any;\r\n  user:IPerformer;\r\n  performer: IPerformer;\r\n  onFollow: Function;\r\n  updateFollower? : Function,\r\n  isTrending?: boolean,\r\n  router:NextRouter\r\n}\r\n\r\nclass ButtonFollow extends PureComponent<IProps> {\r\n  state = {\r\n    status: false,\r\n    loading: false\r\n  };\r\n\r\n  componentDidMount() {\r\n    const { isFollow } = this.props;\r\n    if (isFollow || isFollow === undefined) {\r\n      this.setState({\r\n        status: true\r\n      });\r\n    }\r\n  }\r\n\r\n  handleFollow = async () => {\r\n    const { status } = this.state;\r\n    const {\r\n      targetId,\r\n      sourceId,\r\n      getPerformerList,\r\n      onFollow: dispatchOnFollow,\r\n      updateFollower,\r\n      updateCurrentUser,\r\n      user\r\n    } = this.props;\r\n    try {\r\n      if (status) {\r\n        if (!window.confirm('Are you sure you want to unfollow this person?')) {\r\n          return;\r\n        }\r\n        const stats = { ...user?.stats, totalFollowing: user?.stats.totalFollowing - 1}\r\n        updateCurrentUser({ ...user, stats });\r\n        await this.setState({ loading: true });\r\n        await followService.delete(targetId);\r\n        this.setState({\r\n          status: false\r\n        });\r\n        updateFollower && updateFollower(-1);\r\n        dispatchOnFollow\r\n          && dispatchOnFollow({\r\n            action: 'delete',\r\n            performerId: targetId\r\n          });\r\n      } else {\r\n        await this.setState({ loading: true });\r\n        const stats = { ...user?.stats, totalFollowing: user?.stats.totalFollowing + 1}\r\n        updateCurrentUser({ ...user, stats });\r\n        await followService.create({\r\n          targetId,\r\n          sourceId\r\n        });\r\n        this.setState({\r\n          status: true\r\n        });\r\n        dispatchOnFollow && dispatchOnFollow({\r\n          action: 'create',\r\n          performerId: targetId\r\n        });\r\n        updateFollower && updateFollower(1);\r\n\r\n        getPerformerList();\r\n      }\r\n    } catch (e) {\r\n      const err = await e;\r\n      message.error(err.message || 'error occured, please try again later');\r\n    } finally {\r\n      this.setState({ loading: false });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { status, loading } = this.state;\r\n    const {\r\n      isFollow, title, performer, sourceId, targetId, isTrending, router\r\n    } = this.props;\r\n\r\n   \r\n    if(router.pathname !=='/model' && status){\r\n      return null\r\n    }\r\n\r\n    return (\r\n      <>\r\n        {isFollow ? (\r\n          <>\r\n            {isTrending ? \r\n              <AppButton\r\n                className={`w-full rounded-full bg-transparent text-white border border-white py-1 px-2 hover:bg-black/90 hover:border-black/90`}\r\n                loading={loading}\r\n                size='sm'\r\n                onClick={this.handleFollow}\r\n              >\r\n                <span>Unfollow</span>\r\n              </AppButton>\r\n            :\r\n              <AppButton\r\n                className={`rounded-t-none w-full rounded-b-lg ${ performer.gender === 'male' ? 'bg-blue-900' : ''}`}\r\n                loading={loading}\r\n                onClick={this.handleFollow}\r\n              >\r\n                <span>Unfollow</span>\r\n              </AppButton>\r\n            }\r\n          </>\r\n        ) : (\r\n          <>\r\n            {isTrending ? \r\n              <AppButton\r\n                className={`w-full rounded-full bg-transparent text-white border border-white py-1 px-2 hover:bg-black/90`}\r\n                size='sm'\r\n                loading={loading}\r\n                onClick={this.handleFollow}\r\n              >\r\n                <span>{title || 'Follow'}</span>\r\n              </AppButton>\r\n            :\r\n              <AppButton\r\n                className={`rounded-t-none w-full rounded-b-lg ${ performer.gender === 'male' ? 'bg-blue-900' : ''}`}\r\n                loading={loading}\r\n                onClick={this.handleFollow}\r\n              >\r\n                <span>{title || 'Follow'}</span>\r\n              </AppButton>\r\n            }\r\n          </>\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapState = (state: any) => ({\r\n  user: { ...state.user.current }\r\n});\r\n\r\nconst mapDispatch = {\r\n  onFollow,\r\n  updateCurrentUser\r\n};\r\n\r\nexport default withRouter(connect(mapState, mapDispatch)(ButtonFollow));\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}