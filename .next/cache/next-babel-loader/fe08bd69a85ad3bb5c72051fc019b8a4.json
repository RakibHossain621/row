{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Rokibul\\\\Documents\\\\case\\\\src\\\\components\\\\common\\\\video-player.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport { PureComponent } from 'react';\nimport videojs from 'video.js';\nimport 'node_modules/video.js/dist/video-js.css';\nimport { InView } from 'react-intersection-observer';\nimport { delay } from '@lib/utils';\nexport class VideoPlayer extends PureComponent {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"videoNode\", void 0);\n    _defineProperty(this, \"player\", void 0);\n    _defineProperty(this, \"mounted\", false);\n    _defineProperty(this, \"state\", {\n      isPlayed: false,\n      inView: false\n    });\n    _defineProperty(this, \"handleOnPlay\", () => {\n      const {\n        isPlayed\n      } = this.state;\n      const {\n        onPlay\n      } = this.props;\n      if (isPlayed) return;\n      !isPlayed && this.setState({\n        isPlayed: true\n      });\n      onPlay && onPlay();\n    });\n  }\n  componentDidMount() {\n    this.mounted = true;\n    this.player = videojs(this.videoNode, _objectSpread({}, this.props));\n    this.player.on('play', this.handleOnPlay);\n  }\n  componentDidUpdate(_, prevStates) {\n    const {\n      inView\n    } = this.state;\n    const {\n      playOnScroll\n    } = this.props;\n    if (inView !== prevStates.inView) {\n      if (inView && playOnScroll && this.player) {\n        this.playOnScroll();\n      } else {\n        this.pauseVideo();\n      }\n    }\n  }\n\n  // destroy player on unmount\n  componentWillUnmount() {\n    this.mounted = false;\n    if (this.player) {\n      this.player.dispose();\n      this.player.off('play', this.handleOnPlay);\n    }\n  }\n  onEnded() {\n    this.setState({\n      isPlayed: false\n    }, () => {\n      this.pauseVideo();\n      // if (playLoop) this.playOnScroll();\n    });\n  }\n  pauseVideo() {\n    if (!this.player.paused()) {\n      this.player.pause();\n    }\n  }\n  async playOnScroll() {\n    const {\n      isPlayed,\n      inView\n    } = this.state;\n    await delay(150);\n    if (inView && this.mounted) {\n      !isPlayed && this.player && this.player.paused() && this.player.play();\n    }\n  }\n  render() {\n    return __jsx(\"div\", {\n      className: \"videojs-player\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 7\n      }\n    }, __jsx(\"div\", {\n      \"data-vjs-player\": true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }\n    }, __jsx(InView, {\n      threshold: 1,\n      onChange: inView => this.setState({\n        inView\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }\n    }, __jsx(\"video\", {\n      onContextMenu: event => {\n        event.preventDefault();\n      },\n      disablePictureInPicture: true,\n      \"data-setup\": \"{\\\"controlBar\\\": {\\\"pictureInPictureToggle\\\": false}}\",\n      ref: node => {\n        this.videoNode = node;\n      },\n      className: \"video-js\",\n      onEnded: () => this.onEnded(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }\n    }))));\n  }\n}","map":{"version":3,"names":["PureComponent","videojs","InView","delay","VideoPlayer","constructor","args","_defineProperty","isPlayed","inView","state","onPlay","props","setState","componentDidMount","mounted","player","videoNode","_objectSpread","on","handleOnPlay","componentDidUpdate","_","prevStates","playOnScroll","pauseVideo","componentWillUnmount","dispose","off","onEnded","paused","pause","play","render","__jsx","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","threshold","onChange","onContextMenu","event","preventDefault","disablePictureInPicture","ref","node"],"sources":["C:/Users/Rokibul/Documents/case/src/components/common/video-player.tsx"],"sourcesContent":["import { PureComponent } from 'react';\nimport videojs from 'video.js';\nimport 'node_modules/video.js/dist/video-js.css';\nimport { InView } from 'react-intersection-observer';\nimport { delay } from '@lib/utils';\n\nexport class VideoPlayer extends PureComponent<any> {\n  videoNode: HTMLVideoElement;\n\n  player: any;\n\n  mounted: boolean = false;\n\n  state = {\n    isPlayed: false,\n    inView: false\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.player = videojs(this.videoNode, { ...this.props } as any);\n    this.player.on('play', this.handleOnPlay);\n  }\n\n  componentDidUpdate(_, prevStates) {\n    const { inView } = this.state;\n    const { playOnScroll } = this.props;\n    if (inView !== prevStates.inView) {\n      if (inView && playOnScroll && this.player) {\n        this.playOnScroll();\n      } else {\n        this.pauseVideo();\n      }\n    }\n  }\n\n  // destroy player on unmount\n  componentWillUnmount() {\n    this.mounted = false;\n    if (this.player) {\n      this.player.dispose();\n      this.player.off('play', this.handleOnPlay);\n    }\n  }\n\n  onEnded() {\n    this.setState({ isPlayed: false }, () => {\n      this.pauseVideo();\n      // if (playLoop) this.playOnScroll();\n    });\n  }\n\n  handleOnPlay = () => {\n    const { isPlayed } = this.state;\n    const { onPlay } = this.props;\n    if (isPlayed) return;\n    !isPlayed && this.setState({ isPlayed: true });\n    onPlay && onPlay();\n  };\n\n  pauseVideo() {\n    if (!this.player.paused()) {\n      this.player.pause();\n    }\n  }\n\n  async playOnScroll() {\n    const { isPlayed, inView } = this.state;\n    await delay(150);\n    if (inView && this.mounted) {\n      !isPlayed && this.player && this.player.paused() && this.player.play();\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"videojs-player\">\n        <div data-vjs-player>\n          <InView threshold={1} onChange={(inView) => this.setState({ inView })}>\n            <video\n              onContextMenu={(event) => { event.preventDefault(); }}\n              disablePictureInPicture\n              data-setup='{\"controlBar\": {\"pictureInPictureToggle\": false}}'\n              ref={(node) => {\n                this.videoNode = node;\n              }}\n              className=\"video-js\"\n              onEnded={() => this.onEnded()}\n            />\n          </InView>\n        </div>\n      </div>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}